FROM payara/server-full

# Default payara ports to expose
# 4848: admin console
# 9009: debug port (JPDA)
# 8080: http
# 8181: https
EXPOSE 4848 9009 8080 8181

USER root

ARG JAR_FILE
ARG JDBC_RESOURCE_NAME_ARG
ARG BDD_NAME_URL_ARG
ARG BDD_PORT_ARG
ARG BDD_USER_NAME_ARG
ARG BDD_USER_PASSWORD_ARG
ARG BDD_DB_NAME_ARG

ENV BDD_NAME_URL=${BDD_NAME_URL_ARG}
ENV JDBC_RESOURCE_NAME=${JDBC_RESOURCE_NAME_ARG}
ENV BDD_PORT=${BDD_PORT_ARG}
ENV BDD_USER_NAME=${BDD_USER_NAME_ARG}
ENV BDD_USER_PASSWORD=${BDD_USER_PASSWORD_ARG}
ENV BDD_DB_NAME=${BDD_DB_NAME_ARG}

RUN echo ${JDBC_RESOURCE_NAME_ARG} && echo ${BDD_DB_NAME_ARG} && echo ${BDD_NAME_URL_ARG}}

COPY ./target/${JAR_FILE}.ear $DEPLOY_DIR
COPY ./docker/mysql-connector-java-8.0.19.jar /
COPY  ./docker/post-boot-commands.asadmin $POSTBOOT_COMMANDS

RUN chmod a+x $POSTBOOT_COMMANDS
